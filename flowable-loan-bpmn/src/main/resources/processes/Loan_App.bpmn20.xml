<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.flowable.org/processdef">
  <process id="loanApp" name="Loan App" isExecutable="true">
    <startEvent id="startEvent1" flowable:formFieldValidation="true"></startEvent>
    <userTask id="sid-B4C15D1C-44FF-437F-8CD4-2A4F3D09A222" name="Loan Request Intake" flowable:assignee="test" flowable:formKey="loanRequestIntakeForm" flowable:formFieldValidation="true">
      <extensionElements>
        <modeler:activiti-idm-assignee xmlns:modeler="http://flowable.org/modeler"><![CDATA[true]]></modeler:activiti-idm-assignee>
        <modeler:assignee-info-email xmlns:modeler="http://flowable.org/modeler"><![CDATA[test@gmail.com]]></modeler:assignee-info-email>
        <modeler:assignee-info-firstname xmlns:modeler="http://flowable.org/modeler"><![CDATA[test]]></modeler:assignee-info-firstname>
        <modeler:assignee-info-lastname xmlns:modeler="http://flowable.org/modeler"><![CDATA[t]]></modeler:assignee-info-lastname>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[true]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <sequenceFlow id="sid-D8D413B7-E922-46DE-BE23-0F9742458B40" sourceRef="startEvent1" targetRef="sid-B4C15D1C-44FF-437F-8CD4-2A4F3D09A222"></sequenceFlow>
    <serviceTask id="sid-5A0D3F3E-9D73-4BC4-81E8-30D7024434A8" name="Evaluate Loan Request" flowable:type="dmn">
      <extensionElements>
        <flowable:field name="decisionTableReferenceKey">
          <flowable:string><![CDATA[evaluateLoanRequest]]></flowable:string>
        </flowable:field>
        <flowable:field name="decisionTaskThrowErrorOnNoHits">
          <flowable:string><![CDATA[false]]></flowable:string>
        </flowable:field>
        <flowable:field name="fallbackToDefaultTenant">
          <flowable:string><![CDATA[false]]></flowable:string>
        </flowable:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="sid-D0524411-CAE8-4A4A-AB8B-357FECD8B81A" sourceRef="sid-B4C15D1C-44FF-437F-8CD4-2A4F3D09A222" targetRef="sid-5A0D3F3E-9D73-4BC4-81E8-30D7024434A8"></sequenceFlow>
    <exclusiveGateway id="sid-5CC76A46-A624-4552-9236-5784004295F8"></exclusiveGateway>
    <sequenceFlow id="sid-A02762F5-CE89-41B5-8D17-B6B7A421396B" sourceRef="sid-5A0D3F3E-9D73-4BC4-81E8-30D7024434A8" targetRef="sid-5CC76A46-A624-4552-9236-5784004295F8"></sequenceFlow>
    <endEvent id="sid-0F837F1F-03BE-48A9-9493-DCEC4B8C6977" name="Loan Approved"></endEvent>
    <endEvent id="sid-3C4259ED-92F0-491E-BFEA-F55DCACE49B9" name="Loan Declined"></endEvent>
    <userTask id="sid-BE427B1F-8EAF-4B65-BBE1-12921DED04B0" name="Review Loan Request" flowable:assignee="admin" flowable:formKey="reviewLoanRequestForm" flowable:formFieldValidation="true">
      <extensionElements>
        <modeler:activiti-idm-assignee xmlns:modeler="http://flowable.org/modeler"><![CDATA[true]]></modeler:activiti-idm-assignee>
        <modeler:assignee-info-email xmlns:modeler="http://flowable.org/modeler"><![CDATA[admin@flowable.org]]></modeler:assignee-info-email>
        <modeler:assignee-info-firstname xmlns:modeler="http://flowable.org/modeler"><![CDATA[Test]]></modeler:assignee-info-firstname>
        <modeler:assignee-info-lastname xmlns:modeler="http://flowable.org/modeler"><![CDATA[Administrator]]></modeler:assignee-info-lastname>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[true]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <exclusiveGateway id="sid-3ABDB1F9-087A-4CDF-B250-13E69278F9A9"></exclusiveGateway>
    <sequenceFlow id="sid-A3456FA8-D1E4-48E9-AB04-37C9FBCD54D8" sourceRef="sid-BE427B1F-8EAF-4B65-BBE1-12921DED04B0" targetRef="sid-3ABDB1F9-087A-4CDF-B250-13E69278F9A9"></sequenceFlow>
    <sequenceFlow id="sid-954BE336-5559-4609-ABD5-B6E1C668E855" name="Approved" sourceRef="sid-5CC76A46-A624-4552-9236-5784004295F8" targetRef="sid-BEDAE1EE-6989-438F-9278-7BA3245B5593">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${vars:equals(approvalState, "APPROVED")}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-A17B23DB-EF0B-424C-8D30-7600514D6CEA" name="Declined" sourceRef="sid-5CC76A46-A624-4552-9236-5784004295F8" targetRef="sid-08044071-8980-46CE-A8BB-C8EE4B602F1D">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${vars:equals(approvalState, "DECLINED")}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="sid-BEDAE1EE-6989-438F-9278-7BA3245B5593" flowable:type="http">
      <extensionElements>
        <flowable:field name="requestMethod">
          <flowable:string>POST</flowable:string>
        </flowable:field>
        <flowable:field name="requestUrl">
          <flowable:string>http://localhost:8083/reviewRequest</flowable:string>
        </flowable:field>
        <flowable:field name="requestHeaders">
          <flowable:string><![CDATA[content-type: application/json]]></flowable:string>
        </flowable:field>
        <flowable:field name="requestBody">
          <flowable:expression>
            <![CDATA[{"userId": ${userId}, "approvalState": ${approvalState},"processInstanceId":${execution.processInstanceId}}]]>
          </flowable:expression>
        </flowable:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="sid-2D31405A-D1FF-427D-AD78-871E7FA19C44" name="Approved" sourceRef="sid-3ABDB1F9-087A-4CDF-B250-13E69278F9A9" targetRef="sid-BEDAE1EE-6989-438F-9278-7BA3245B5593">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${loanStatus == "Approved"}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-C9244FB2-BFE5-4530-AB58-E789A4655FFE" sourceRef="sid-BEDAE1EE-6989-438F-9278-7BA3245B5593" targetRef="sid-0F837F1F-03BE-48A9-9493-DCEC4B8C6977"></sequenceFlow>
    <serviceTask id="sid-50F3C511-6E3F-4CC2-81E1-3D4728C222FD" flowable:type="http">
      <extensionElements>
        <flowable:field name="requestMethod">
          <flowable:string>POST</flowable:string>
        </flowable:field>
        <flowable:field name="requestUrl">
          <flowable:string>http://localhost:8082/api/maker/test</flowable:string>
        </flowable:field>
        <flowable:field name="requestHeaders">
          <flowable:string><![CDATA[content-type: application/json]]></flowable:string>
        </flowable:field>
        <flowable:field name="requestBody">
          <flowable:expression>
            <![CDATA[{"userId": ${userId}, "approvalState": ${approvalState},"processInstanceId":${execution.processInstanceId}}]]>
          </flowable:expression>
        </flowable:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="sid-39006D6A-338C-44DC-B633-DA6FBA7991E3" sourceRef="sid-5CC76A46-A624-4552-9236-5784004295F8" targetRef="sid-50F3C511-6E3F-4CC2-81E1-3D4728C222FD"></sequenceFlow>
    <sequenceFlow id="sid-65E80240-FE91-482B-AF6C-41BCC5BBA202" sourceRef="sid-50F3C511-6E3F-4CC2-81E1-3D4728C222FD" targetRef="sid-BE427B1F-8EAF-4B65-BBE1-12921DED04B0"></sequenceFlow>
    <serviceTask id="sid-08044071-8980-46CE-A8BB-C8EE4B602F1D" flowable:type="http">
      <extensionElements>
        <flowable:field name="requestMethod">
          <flowable:string>POST</flowable:string>
        </flowable:field>
        <flowable:field name="requestUrl">
          <flowable:string>http://localhost:8082/api/maker/test</flowable:string>
        </flowable:field>
        <flowable:field name="requestHeaders">
          <flowable:string><![CDATA[content-type: application/json]]></flowable:string>
        </flowable:field>
        <flowable:field name="requestBody">
          <flowable:expression>
            <![CDATA[{"userId": ${userId}, "approvalState": ${approvalState},"processInstanceId":${execution.processInstanceId}}]]>
          </flowable:expression>
        </flowable:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="sid-0413332A-F525-4E07-97CA-DDEC035E2EA6" name="Declined" sourceRef="sid-3ABDB1F9-087A-4CDF-B250-13E69278F9A9" targetRef="sid-08044071-8980-46CE-A8BB-C8EE4B602F1D">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${loanStatus == "Declined"}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-0135A258-B106-4C1E-A5FE-3101BDA9B8DD" sourceRef="sid-08044071-8980-46CE-A8BB-C8EE4B602F1D" targetRef="sid-3C4259ED-92F0-491E-BFEA-F55DCACE49B9"></sequenceFlow>
  </process>
</definitions>